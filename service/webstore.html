<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf8"/>
  <meta name="viewport" content="width=device-width"/>
  <link rel="shortcut icon" href="favicon.png" type="image/png" />
  <title>Chrome Extension Store for Enterprise</title>
    <script>
      async function installWithManifest(appId) {
        const manifest = (await (await fetch('/service/crx/manifest.json?appId=' + appId)).text());
        chrome.webstorePrivate.beginInstallWithManifest3(
          { id: appId, manifest: manifest },
          function() {
            if (chrome.runtime.lastError) {
              const msg = chrome.runtime.lastError.message || "No last error message";
              alert(msg);
              console.log("Error on beginInstallWithManifest3: " + msg, chrome.runtime.lastError);
            } else {
              chrome.webstorePrivate.completeInstall(appId, function(d,e,f) {
                if (chrome.runtime.lastError) {
                  const msg = chrome.runtime.lastError.message || "No last error message";
                  alert(msg);
                  console.log("Error on completeInstall: " + msg, chrome.runtime.lastError);
                }
              });
            }
          }
        );
      }
    </script>
</head>
<body>
<p>Extensions available:</p>
<ul>
    <li><b>DEMO EXTENSION</b> &mdash; <button onclick="installWithManifest('demoknhoknhkmcponecodnkfphccjjbo')">Install</button></li>
</ul>
</body>
</html>
